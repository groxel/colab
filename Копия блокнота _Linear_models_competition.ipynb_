{"cells":[{"cell_type":"markdown","id":"3b5c592b","metadata":{"id":"3b5c592b"},"source":["# Пример решения соревнования по линейным моделям"]},{"cell_type":"markdown","id":"54ead815","metadata":{"id":"54ead815"},"source":["## Импорт необходимых библиотек"]},{"cell_type":"markdown","id":"a40824aa","metadata":{"id":"a40824aa"},"source":["Импортируем библиотеку pandas для работы с табличными данными"]},{"cell_type":"code","execution_count":null,"id":"f9f593c4","metadata":{"id":"f9f593c4"},"outputs":[],"source":["import pandas as pd\n","\n","from sklearn.preprocessing import LabelEncoder\n","from sklearn.linear_model import LinearRegression\n","from sklearn.model_selection import train_test_split\n","from sklearn.metrics import mean_absolute_error as mae"]},{"cell_type":"markdown","id":"18e83094","metadata":{"id":"18e83094"},"source":["# Подгрузка данных"]},{"cell_type":"code","source":["!pip install gdown"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"I8LyNHHZpS32","outputId":"4cb6611c-21c7-4a9e-8dd9-328dd81ddf8e"},"id":"I8LyNHHZpS32","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: gdown in /usr/local/lib/python3.10/dist-packages (4.6.6)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from gdown) (3.12.4)\n","Requirement already satisfied: requests[socks] in /usr/local/lib/python3.10/dist-packages (from gdown) (2.31.0)\n","Requirement already satisfied: six in /usr/local/lib/python3.10/dist-packages (from gdown) (1.16.0)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from gdown) (4.66.1)\n","Requirement already satisfied: beautifulsoup4 in /usr/local/lib/python3.10/dist-packages (from gdown) (4.11.2)\n","Requirement already satisfied: soupsieve>1.2 in /usr/local/lib/python3.10/dist-packages (from beautifulsoup4->gdown) (2.5)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests[socks]->gdown) (3.3.0)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests[socks]->gdown) (3.4)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests[socks]->gdown) (2.0.6)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests[socks]->gdown) (2023.7.22)\n","Requirement already satisfied: PySocks!=1.5.7,>=1.5.6 in /usr/local/lib/python3.10/dist-packages (from requests[socks]->gdown) (1.7.1)\n"]}]},{"cell_type":"code","source":["!gdown https://drive.google.com/uc?id=1p1HtCvxqnDNfk52_Pcli6IlTFxtlXLUK\n","!gdown https://drive.google.com/uc?id=1ZinEL6IyBvxzygqUfjqZQsTeZMC7mBm4\n","!gdown https://drive.google.com/uc?id=1xcm2nFUykNqau4IqYLy3Ri_9OcurZnZn"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"mn0XZ-dhpUfM","outputId":"6cbc09f3-13b0-4340-f8e9-bbd159c09ef8"},"id":"mn0XZ-dhpUfM","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Downloading...\n","From: https://drive.google.com/uc?id=1p1HtCvxqnDNfk52_Pcli6IlTFxtlXLUK\n","To: /content/train_set.csv\n","100% 807k/807k [00:00<00:00, 23.4MB/s]\n","Downloading...\n","From: https://drive.google.com/uc?id=1ZinEL6IyBvxzygqUfjqZQsTeZMC7mBm4\n","To: /content/test_set.csv\n","100% 180k/180k [00:00<00:00, 19.3MB/s]\n","Downloading...\n","From: https://drive.google.com/uc?id=1xcm2nFUykNqau4IqYLy3Ri_9OcurZnZn\n","To: /content/ford_price_kaggle_sample_submission.csv\n","100% 87.2k/87.2k [00:00<00:00, 106MB/s]\n"]}]},{"cell_type":"code","execution_count":null,"id":"e2dbaf14","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"e2dbaf14","outputId":"966ce046-00cb-4dbe-a756-7f126b916501"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   automobile_id   model  year  price transmission  mileage fuelType  tax  \\\n","0              0  Fiesta  2018  12000       Manual    30418   Petrol  145   \n","1              1  Fiesta  2016   9790       Manual    35047   Diesel    0   \n","2              2    Edge  2018  32000    Automatic    11007   Diesel  145   \n","3              3    Kuga  2017  17595    Semi-Auto    18066   Diesel  145   \n","4              4   Focus  2017   9998       Manual    34025   Petrol   20   \n","\n","    mpg  engineSize  \n","0  62.8         1.0  \n","1  78.5         1.5  \n","2  37.2         2.0  \n","3  54.3         2.0  \n","4  60.1         1.0  "],"text/html":["\n","  <div id=\"df-8274e606-4f71-41fc-ac10-035447d9e547\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>automobile_id</th>\n","      <th>model</th>\n","      <th>year</th>\n","      <th>price</th>\n","      <th>transmission</th>\n","      <th>mileage</th>\n","      <th>fuelType</th>\n","      <th>tax</th>\n","      <th>mpg</th>\n","      <th>engineSize</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>Fiesta</td>\n","      <td>2018</td>\n","      <td>12000</td>\n","      <td>Manual</td>\n","      <td>30418</td>\n","      <td>Petrol</td>\n","      <td>145</td>\n","      <td>62.8</td>\n","      <td>1.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>Fiesta</td>\n","      <td>2016</td>\n","      <td>9790</td>\n","      <td>Manual</td>\n","      <td>35047</td>\n","      <td>Diesel</td>\n","      <td>0</td>\n","      <td>78.5</td>\n","      <td>1.5</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>Edge</td>\n","      <td>2018</td>\n","      <td>32000</td>\n","      <td>Automatic</td>\n","      <td>11007</td>\n","      <td>Diesel</td>\n","      <td>145</td>\n","      <td>37.2</td>\n","      <td>2.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3</td>\n","      <td>Kuga</td>\n","      <td>2017</td>\n","      <td>17595</td>\n","      <td>Semi-Auto</td>\n","      <td>18066</td>\n","      <td>Diesel</td>\n","      <td>145</td>\n","      <td>54.3</td>\n","      <td>2.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>Focus</td>\n","      <td>2017</td>\n","      <td>9998</td>\n","      <td>Manual</td>\n","      <td>34025</td>\n","      <td>Petrol</td>\n","      <td>20</td>\n","      <td>60.1</td>\n","      <td>1.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-8274e606-4f71-41fc-ac10-035447d9e547')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-8274e606-4f71-41fc-ac10-035447d9e547 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-8274e606-4f71-41fc-ac10-035447d9e547');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-f44abf1c-a75d-4ebe-ac9d-a955274e3909\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-f44abf1c-a75d-4ebe-ac9d-a955274e3909')\"\n","            title=\"Suggest charts.\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-f44abf1c-a75d-4ebe-ac9d-a955274e3909 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"]},"metadata":{},"execution_count":18}],"source":["df = pd.read_csv('train_set.csv')\n","df.head()"]},{"cell_type":"markdown","id":"1dfc7e38","metadata":{"id":"1dfc7e38"},"source":["Наши данные содержат следующие признаки\n","\n","- **automobile_id** - идентификатор автомобиля;\n","- **model** - Модель автомобиля;\n","- **year** - Год выпуса;\n","- **price** - Цена автомобиля. *Целевая переменная*;\n","- **transmission** - Тип коробки передач: Automatic (автоматическая), Manual (ручная), Semi-Auto (полуавтомат);\n","- **mileage** -> Пробег в милях;\n","- **fuel_Type** -> Вид топлива: Petrol (бензин), Diesel (дизель), Hybrid (гибрид), Electric (электроавтомобиль), Other (другое);\n","- **tax** -> Размер налога на автомобиль;\n","- **mpg** - Потребление топлива: галлоны на милю;\n","- **engineSize** - Объем двигателя."]},{"cell_type":"code","execution_count":null,"id":"95ebe385","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"95ebe385","outputId":"0ddba363-69b4-4d20-a252-b5ac7fee54be"},"outputs":[{"output_type":"stream","name":"stdout","text":["<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 14368 entries, 0 to 14367\n","Data columns (total 10 columns):\n"," #   Column         Non-Null Count  Dtype  \n","---  ------         --------------  -----  \n"," 0   automobile_id  14368 non-null  int64  \n"," 1   model          14368 non-null  object \n"," 2   year           14368 non-null  int64  \n"," 3   price          14368 non-null  int64  \n"," 4   transmission   14368 non-null  object \n"," 5   mileage        14368 non-null  int64  \n"," 6   fuelType       14368 non-null  object \n"," 7   tax            14368 non-null  int64  \n"," 8   mpg            14368 non-null  float64\n"," 9   engineSize     14368 non-null  float64\n","dtypes: float64(2), int64(5), object(3)\n","memory usage: 1.1+ MB\n"]}],"source":["df.info()"]},{"cell_type":"code","execution_count":null,"id":"4776a5ce","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"4776a5ce","outputId":"b3f5f476-e12f-4c8e-830e-e2929fe834a6"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["automobile_id    14368\n","model               19\n","year                21\n","price             3122\n","transmission         3\n","mileage          11236\n","fuelType             5\n","tax                 34\n","mpg                 85\n","engineSize          15\n","dtype: int64"]},"metadata":{},"execution_count":20}],"source":["df.nunique()"]},{"cell_type":"markdown","id":"c46f3777","metadata":{"id":"c46f3777"},"source":["## Подготовка данных"]},{"cell_type":"markdown","id":"517035a8","metadata":{"id":"517035a8"},"source":["Переведем наши категории в числовые значения, так как линейные модели не умеют работать с категориями напрямую. Сохраним енкодеры в словарь чтобы потом переиспользовать их."]},{"cell_type":"code","execution_count":null,"id":"7fe91fea","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"7fe91fea","outputId":"8590419f-50a9-43cd-fcbb-94ab6c426080"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   automobile_id  model  year  price  transmission  mileage  fuelType  tax  \\\n","0              0      4  2018  12000             1    30418         4  145   \n","1              1      4  2016   9790             1    35047         0    0   \n","2              2      3  2018  32000             0    11007         0  145   \n","3              3     12  2017  17595             2    18066         0  145   \n","4              4      5  2017   9998             1    34025         4   20   \n","\n","    mpg  engineSize  \n","0  62.8         1.0  \n","1  78.5         1.5  \n","2  37.2         2.0  \n","3  54.3         2.0  \n","4  60.1         1.0  "],"text/html":["\n","  <div id=\"df-5231b269-90d2-477b-9700-86c5fb1f0476\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>automobile_id</th>\n","      <th>model</th>\n","      <th>year</th>\n","      <th>price</th>\n","      <th>transmission</th>\n","      <th>mileage</th>\n","      <th>fuelType</th>\n","      <th>tax</th>\n","      <th>mpg</th>\n","      <th>engineSize</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>4</td>\n","      <td>2018</td>\n","      <td>12000</td>\n","      <td>1</td>\n","      <td>30418</td>\n","      <td>4</td>\n","      <td>145</td>\n","      <td>62.8</td>\n","      <td>1.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>4</td>\n","      <td>2016</td>\n","      <td>9790</td>\n","      <td>1</td>\n","      <td>35047</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>78.5</td>\n","      <td>1.5</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>3</td>\n","      <td>2018</td>\n","      <td>32000</td>\n","      <td>0</td>\n","      <td>11007</td>\n","      <td>0</td>\n","      <td>145</td>\n","      <td>37.2</td>\n","      <td>2.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3</td>\n","      <td>12</td>\n","      <td>2017</td>\n","      <td>17595</td>\n","      <td>2</td>\n","      <td>18066</td>\n","      <td>0</td>\n","      <td>145</td>\n","      <td>54.3</td>\n","      <td>2.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>5</td>\n","      <td>2017</td>\n","      <td>9998</td>\n","      <td>1</td>\n","      <td>34025</td>\n","      <td>4</td>\n","      <td>20</td>\n","      <td>60.1</td>\n","      <td>1.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-5231b269-90d2-477b-9700-86c5fb1f0476')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-5231b269-90d2-477b-9700-86c5fb1f0476 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-5231b269-90d2-477b-9700-86c5fb1f0476');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-4e322dd2-6125-449a-82fc-5b6c2ef01352\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-4e322dd2-6125-449a-82fc-5b6c2ef01352')\"\n","            title=\"Suggest charts.\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-4e322dd2-6125-449a-82fc-5b6c2ef01352 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"]},"metadata":{},"execution_count":21}],"source":["cat_cols = ['model', 'transmission', 'fuelType']\n","\n","dict_encoders = dict()\n","\n","for col in cat_cols:\n","    encoder = LabelEncoder()\n","    df[col] = encoder.fit_transform(df[col])\n","    dict_encoders[col] = encoder\n","\n","df.head()"]},{"cell_type":"markdown","id":"c19c63d0","metadata":{"id":"c19c63d0"},"source":["Разделим данные на обучающую и тестовую выборку"]},{"cell_type":"code","execution_count":null,"id":"bb3347f0","metadata":{"id":"bb3347f0"},"outputs":[],"source":["X = df.drop(['price'], axis=1)\n","y = df['price']\n","\n","X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)"]},{"cell_type":"markdown","id":"dbaa2eee","metadata":{"id":"dbaa2eee"},"source":["## Обучение модели и предсказание"]},{"cell_type":"markdown","id":"9593e22b","metadata":{"id":"9593e22b"},"source":["В качестве бейзлайна используем модель линейной регрессии"]},{"cell_type":"code","execution_count":null,"id":"a7b76182","metadata":{"id":"a7b76182"},"outputs":[],"source":["model = LinearRegression()\n","model.fit(X_train, y_train)\n","\n","y_pred_train = model.predict(X_train)\n","y_pred_test = model.predict(X_test)"]},{"cell_type":"code","execution_count":null,"id":"ea4b431c","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ea4b431c","outputId":"be7b1a17-00d1-48ea-d501-eb7c6ec2fae2"},"outputs":[{"output_type":"stream","name":"stdout","text":["Train absolute error:  1759.530617059704\n","Test absolute error:  1741.170707496115\n"]}],"source":["print('Train absolute error: ', mae(y_train, y_pred_train))\n","print('Test absolute error: ', mae(y_test, y_pred_test))"]},{"cell_type":"markdown","id":"c2cce194","metadata":{"id":"c2cce194"},"source":["## Подготовка финального предсказания"]},{"cell_type":"markdown","id":"e6f630ef","metadata":{"id":"e6f630ef"},"source":["Подгрузим тестовую выборку и шаблон для отправки данных"]},{"cell_type":"code","execution_count":null,"id":"9a1ef18e","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"9a1ef18e","outputId":"8c5e4544-c120-4550-cb7b-b51dabbdc9dd"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   automobile_id   model  year transmission  mileage fuelType  tax   mpg  \\\n","0              0   Focus  2013       Manual    47781   Petrol   30  56.5   \n","1              1  Galaxy  2019    Semi-Auto     3763   Diesel  145  54.3   \n","2              2  Fiesta  2017       Manual    47959   Diesel    0  78.5   \n","3              3  Fiesta  2010       Manual    99000   Petrol  145  49.6   \n","4              4  Fiesta  2018       Manual    13820   Petrol  145  65.7   \n","\n","   engineSize  \n","0         1.0  \n","1         2.0  \n","2         1.5  \n","3         1.2  \n","4         1.0  "],"text/html":["\n","  <div id=\"df-98089bc7-9ea8-492c-a52e-bc8a40aca440\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>automobile_id</th>\n","      <th>model</th>\n","      <th>year</th>\n","      <th>transmission</th>\n","      <th>mileage</th>\n","      <th>fuelType</th>\n","      <th>tax</th>\n","      <th>mpg</th>\n","      <th>engineSize</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>Focus</td>\n","      <td>2013</td>\n","      <td>Manual</td>\n","      <td>47781</td>\n","      <td>Petrol</td>\n","      <td>30</td>\n","      <td>56.5</td>\n","      <td>1.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>Galaxy</td>\n","      <td>2019</td>\n","      <td>Semi-Auto</td>\n","      <td>3763</td>\n","      <td>Diesel</td>\n","      <td>145</td>\n","      <td>54.3</td>\n","      <td>2.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>Fiesta</td>\n","      <td>2017</td>\n","      <td>Manual</td>\n","      <td>47959</td>\n","      <td>Diesel</td>\n","      <td>0</td>\n","      <td>78.5</td>\n","      <td>1.5</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3</td>\n","      <td>Fiesta</td>\n","      <td>2010</td>\n","      <td>Manual</td>\n","      <td>99000</td>\n","      <td>Petrol</td>\n","      <td>145</td>\n","      <td>49.6</td>\n","      <td>1.2</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>Fiesta</td>\n","      <td>2018</td>\n","      <td>Manual</td>\n","      <td>13820</td>\n","      <td>Petrol</td>\n","      <td>145</td>\n","      <td>65.7</td>\n","      <td>1.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-98089bc7-9ea8-492c-a52e-bc8a40aca440')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-98089bc7-9ea8-492c-a52e-bc8a40aca440 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-98089bc7-9ea8-492c-a52e-bc8a40aca440');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-a46694d4-84bf-4429-91d2-ea05207ac1b3\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-a46694d4-84bf-4429-91d2-ea05207ac1b3')\"\n","            title=\"Suggest charts.\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-a46694d4-84bf-4429-91d2-ea05207ac1b3 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"]},"metadata":{},"execution_count":25}],"source":["df_test = pd.read_csv('test_set.csv')\n","submit_data = pd.read_csv('ford_price_kaggle_sample_submission.csv')\n","df_test.head()"]},{"cell_type":"markdown","id":"a86944de","metadata":{"id":"a86944de"},"source":["Чтобы для предсказания на новом датасете необходимо повторить все шаги, совершенные нами ранее. Важно использовать те же методы подготовки данных и обученные модели.\n","\n","Используем уже имеющиеся енкодеры для преобразования категориальных переменных"]},{"cell_type":"code","execution_count":null,"id":"2d9ffbfc","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"2d9ffbfc","outputId":"4033891d-384d-4df7-8409-a2211af9fe8a"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   automobile_id  model  year  transmission  mileage  fuelType  tax   mpg  \\\n","0              0      5  2013             1    47781         4   30  56.5   \n","1              1      7  2019             2     3763         0  145  54.3   \n","2              2      4  2017             1    47959         0    0  78.5   \n","3              3      4  2010             1    99000         4  145  49.6   \n","4              4      4  2018             1    13820         4  145  65.7   \n","\n","   engineSize  \n","0         1.0  \n","1         2.0  \n","2         1.5  \n","3         1.2  \n","4         1.0  "],"text/html":["\n","  <div id=\"df-aedc8dd5-4fd6-4f22-a08f-abad44cec6e3\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>automobile_id</th>\n","      <th>model</th>\n","      <th>year</th>\n","      <th>transmission</th>\n","      <th>mileage</th>\n","      <th>fuelType</th>\n","      <th>tax</th>\n","      <th>mpg</th>\n","      <th>engineSize</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>5</td>\n","      <td>2013</td>\n","      <td>1</td>\n","      <td>47781</td>\n","      <td>4</td>\n","      <td>30</td>\n","      <td>56.5</td>\n","      <td>1.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>7</td>\n","      <td>2019</td>\n","      <td>2</td>\n","      <td>3763</td>\n","      <td>0</td>\n","      <td>145</td>\n","      <td>54.3</td>\n","      <td>2.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>4</td>\n","      <td>2017</td>\n","      <td>1</td>\n","      <td>47959</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>78.5</td>\n","      <td>1.5</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3</td>\n","      <td>4</td>\n","      <td>2010</td>\n","      <td>1</td>\n","      <td>99000</td>\n","      <td>4</td>\n","      <td>145</td>\n","      <td>49.6</td>\n","      <td>1.2</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>4</td>\n","      <td>2018</td>\n","      <td>1</td>\n","      <td>13820</td>\n","      <td>4</td>\n","      <td>145</td>\n","      <td>65.7</td>\n","      <td>1.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-aedc8dd5-4fd6-4f22-a08f-abad44cec6e3')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-aedc8dd5-4fd6-4f22-a08f-abad44cec6e3 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-aedc8dd5-4fd6-4f22-a08f-abad44cec6e3');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-c948a690-3bc7-4f81-86c6-6734c9003bb5\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-c948a690-3bc7-4f81-86c6-6734c9003bb5')\"\n","            title=\"Suggest charts.\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-c948a690-3bc7-4f81-86c6-6734c9003bb5 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"]},"metadata":{},"execution_count":26}],"source":["for col in cat_cols:\n","    encoder = dict_encoders[col]\n","    df_test[col] = encoder.transform(df_test[col])\n","\n","df_test.head()"]},{"cell_type":"markdown","id":"cb0ae1ee","metadata":{"id":"cb0ae1ee"},"source":["Сделаем предсказание уже обученной моделью и сохраним его в файл для отправки"]},{"cell_type":"code","execution_count":null,"id":"d97824ab","metadata":{"id":"d97824ab"},"outputs":[],"source":["y_pred = model.predict(df_test)\n","submit_data['price'] = y_pred\n","\n","submit_data.to_csv('my_submisson.csv', index=False)"]},{"cell_type":"code","source":["from google.colab import files\n","files.download('my_submisson.csv')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":17},"id":"T_rNykEoo3HE","outputId":"abfc83ef-dba2-44de-8fab-574f5696957c"},"id":"T_rNykEoo3HE","execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Javascript object>"],"application/javascript":["\n","    async function download(id, filename, size) {\n","      if (!google.colab.kernel.accessAllowed) {\n","        return;\n","      }\n","      const div = document.createElement('div');\n","      const label = document.createElement('label');\n","      label.textContent = `Downloading \"${filename}\": `;\n","      div.appendChild(label);\n","      const progress = document.createElement('progress');\n","      progress.max = size;\n","      div.appendChild(progress);\n","      document.body.appendChild(div);\n","\n","      const buffers = [];\n","      let downloaded = 0;\n","\n","      const channel = await google.colab.kernel.comms.open(id);\n","      // Send a message to notify the kernel that we're ready.\n","      channel.send({})\n","\n","      for await (const message of channel.messages) {\n","        // Send a message to notify the kernel that we're ready.\n","        channel.send({})\n","        if (message.buffers) {\n","          for (const buffer of message.buffers) {\n","            buffers.push(buffer);\n","            downloaded += buffer.byteLength;\n","            progress.value = downloaded;\n","          }\n","        }\n","      }\n","      const blob = new Blob(buffers, {type: 'application/binary'});\n","      const a = document.createElement('a');\n","      a.href = window.URL.createObjectURL(blob);\n","      a.download = filename;\n","      div.appendChild(a);\n","      a.click();\n","      div.remove();\n","    }\n","  "]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Javascript object>"],"application/javascript":["download(\"download_ed97535e-6805-4c38-bada-5c73333914bc\", \"my_submisson.csv\", 83596)"]},"metadata":{}}]},{"cell_type":"markdown","id":"42b1b3c9","metadata":{"id":"42b1b3c9"},"source":["## Идеи для улучшения\n"," - изменить способ подготовки данных\n"," - использовать модель с другими параметрами\n"," - подобрать гиперпараметры модели"]}],"metadata":{"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.8"},"colab":{"provenance":[{"file_id":"1Z1E4zcQDjF5t3Q-b2815e4nTQSDn7nR5","timestamp":1737551072556}]}},"nbformat":4,"nbformat_minor":5}